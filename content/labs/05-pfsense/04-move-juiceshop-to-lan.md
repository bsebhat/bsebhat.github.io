---
title: 04 Connect juicero to LAN
type: docs
---

## Connect juicero NIC to LAN
I use the same method of changing the network source for the NIC on the `juicero` VM.

## Change juicero NetworkManager settings
The `juicero` VM  uses a static IP address, because it's a server and I want to use that IP in other VMs. So to allow communication between the `jucieshop` NIC and the other VMs on the `LAN` network, I need to change its static IP address from `192.168.122.10` to `192.168.1.10`. It could be anything between `192.168.1.2` dnd `192.168.1.254`, but I want the static IPs using the addresses not in the DHCP range, and to keep the 21 in the last octet.

I'll use the NetworkManager cli tool `nmcli` on `juicero` to change the static IP, gateway and and DNS settings for the "Wired Connection 1" connection:
```
nmcli connection modify enp1s0 ipv4.address 192.168.1.10/24
nmcli connection modify enp1s0 ipv4.gateway 192.168.1.1
nmcli connection modify enp1s0 ipv4.dns 192.168.1.1
nmcli connection up enp1s0
```

To help make setting IPv4 settings easier, I got this bash script from ChatGPT:
```bash
#!/bin/bash

# generated by ChatGPT
# run: sudo ./set-static-ip.sh
# uses nmcli NetworkManager tool to change
# IPv4 address, gateway, dns, and method to manual
# using default values

# Ensure the script is run as root or with sudo
if [[ $EUID -ne 0 ]]; then
   echo "Please run this script with sudo or as root"
   exit 1
fi

# Provide default values
default_conn_name="enp1s0"
default_cidr="24"

# Prompt the user for input
read -p "Enter NetworkManager connection name [${default_conn_name}]: " conn_name
conn_name=${conn_name:-$default_conn_name}

read -p "Enter Static IP address: " ip_addr
read -p "Enter CIDR (subnet mask, e.g., 24 for 255.255.255.0) [${default_cidr}]: " cidr
cidr=${cidr:-$default_cidr}

# Extract network part of the IP to generate default gateway and DNS values
IFS='.' read -ra ADDR <<< "$ip_addr"
default_gateway="${ADDR[0]}.${ADDR[1]}.${ADDR[2]}.1"
default_dns="$default_gateway"

read -p "Enter default gateway [${default_gateway}]: " gateway
gateway=${gateway:-$default_gateway}

read -p "Enter preferred DNS [${default_dns}]: " dns
dns=${dns:-$default_dns}

# Use nmcli to set the static IP
nmcli con mod "$conn_name" ipv4.addresses "${ip_addr}/${cidr}"
nmcli con mod "$conn_name" ipv4.gateway "$gateway"
nmcli con mod "$conn_name" ipv4.dns "$dns"
nmcli con mod "$conn_name" ipv4.method manual

# Bring the connection up to apply the changes
if nmcli con up "$conn_name"; then
    # If successful, show the device details filtered for IP4
    nmcli device show | grep "IP4"
else
    # Otherwise, print an error message
    echo "Failed to apply changes. Please check your input and try again."
fi

```

When I run `sudo ./set-static-ip.sh`, I can enter the static IP and the dns, gateway, and subnet mask in CIRD notation (or use default values), and it runs the `nmcli` commands to change those ipv4 settings:
```
Enter NetworkManager connection name [enp1s0]: 
Enter Static IP address: 192.168.1.10
Enter CIDR (subnet mask, e.g., 24 for 255.255.255.0) [24]: 
Enter default gateway [192.168.1.1]: 
Enter preferred DNS [192.168.1.1]: 
Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/3)
IP4.ADDRESS[1]:                         192.168.1.10/24
IP4.GATEWAY:                            192.168.1.1
IP4.ROUTE[1]:                           dst = 192.168.1.0/24, nh = 0.0.0.0, mt = 100
IP4.ROUTE[2]:                           dst = 0.0.0.0/0, nh = 192.168.1.1, mt = 100
IP4.DNS[1]:                             192.168.1.1
IP4.ADDRESS[1]:                         127.0.0.1/8
IP4.GATEWAY:                            --
```

## Test Network Connection
I am able to ping the `juicero` from the `sysadmin` VM, and I can visit that Juice Shop web application running on it.


But I need to allow the customer on the `customer` VM to access the `juicero` VM. The `customer` isn't connected to the `LAN` isolated network I created. I only want the VMs running the Juice Shop web application on that internal network.

So I'll need to configure the `pfsense` firewall server to act like a gateway between the customer and the website, forwarding web requests from the "WAN" interface to the `customer` VM.