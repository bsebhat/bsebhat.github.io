---
title: 01 Use pentester To Exploit
type: docs
---

I'm going to use this `pentester` VM to exploit some of the [built-in vulnerabilities](https://pwning.owasp-juice.shop/companion-guide/latest/appendix/solutions.html) of the Juice Shop web application. The vulnerabilities are considered "challenges" that test the skills of penetration testers. Some challenges are considered easier, and have a "one star" score. The more difficult the exploit, the more stars.

They are also organized into [vulnerability categories](https://owasp.org/www-project-juice-shop/#div-challenges), like "Broken Authentication" and "Improper Input Validation".

## Install Burp Suite
For some of the exploits, I'll be using a penetration testing tool called [Burp Suite](https://portswigger.net/burp/). I'll install the community edition aur package:
```
yay -S burpsuite
```

## Exploit Juice Shop Web App
The Juice Shop web application was built by OWASP to demonstrate some of the most common web application vulnerabilities. I've picked an exploit I found on the official OWASP challenge solutions page: [Put an additional product into another userâ€™s shopping basket](https://pwning.owasp-juice.shop/companion-guide/latest/appendix/solutions.html#_put_an_additional_product_into_another_users_shopping_basket)


## pentester Adds Product To juicefan Basket
I use the `pentester` desktop to exploit a [broken access control] vulnerability in the Juice Shop basket feature.

I'm not going to go through all of the steps involved, just a high level overview of what `pentester` does. There is a great [Hacksplained YouTube video walkthrough](https://www.youtube.com/watch?v=pdtDtmIiSOQ) and [a blog post](https://curiositykillscolby.com/2020/12/02/pwning-owasps-juice-shop-pt-37-manipulate-basket/) showing how to use the Burp Suite penetration testing tool to manipulate the API.

First, `juicefan` puts some juice in their basket:
![juicefan basket 1](../juicefan-basket-1.png)

Then, another user, `pentester`, creates an account and tries to exploit a vulnerability in the web application. When a user adds an item to their basket, the browser sends an HTTP request to the rest API, sending a `BasketId` and `ProductId`. They try to change the `BasketId`, but it returns an HTTP error, `401 Unauthorized`: 
![pentester first attempt](../pentester-first-attempt.png)

But they keep trying. This time, sending two `BasketId`s, the first one being
![pentester-success](../pentester-success.png)


## juicefan Email To sysadmin
And so now, the `juicefan` wakes up, opens their computer, goes to the Juice Shop website to checkout their basket and finds a $3000 bike was added:
![juicefan bad](../juicefan-bad.png)

So `juicefan` sends this email to the `sysadmin`:

```
From: juicefan
To: sysadmin

Dear Juice Shop,

I'm a hug fan of your website.
I love drinking juice.
But I just found a $3000 bike added to my basket!
I didn't put it in my basket.
I've been hacked.
I have been a loyal customer.
Please fix this!

Sincerely,
Juice Fan
```

## sysadmin Investigates Access Logs
So now `sysadmin` needs to SSH into the `juiceshop` web server, get sudo access to go into the `/opt/juice-shop/logs` directory, and go through the access logs for the web application and try to understand what happened.
![sysadmin logs](../sysadmin-logs.png)

Opening the access log for today, `access.log.2023-10-23`, there are over 500 lines.
![access log today](../access-log-today.png)

## syadmin Adds a SOC
To help monitor for future security incidents like this, a security operations center (SOC) will be added to the network. A separate `SOC` network will be added, like with `DMZ`. And a `soc-analyst` desktop VM similar to `sysadmin` will be added. That will be used to access a server running a Splunk server that takes all the log data and makes it easy to access and analyze.